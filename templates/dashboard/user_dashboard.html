{% extends "base.html" %}

{% block title %}User Dashboard - WhatsApp Analytics{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/user_dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="dashboard-layout">
    <!-- Include User Left Sidebar from Layout File -->
    {% include 'user_slidebar.html' %}
    
    <!-- Main Content Area -->
    <div class="main-content">
        <!-- Modern Header -->
        <div class="modern-header">
            <div class="header-content">
                <div class="header-title">
                    <h1><i class="fas fa-chart-line"></i> Dashboard Analytics</h1>
                    <p class="header-subtitle">Comprehensive overview of your WhatsApp data insights</p>
                </div>
                <div class="header-stats">
                    <div class="quick-stat">
                        <span class="stat-value" id="quickTotalAssemblies">0</span>
                        <span class="stat-label">Assemblies</span>
                    </div>
                    <div class="quick-stat">
                        <span class="stat-value" id="quickTotalGroups">0</span>
                        <span class="stat-label">Groups</span>
                    </div>
                    <div class="quick-stat">
                        <span class="stat-value" id="quickTotalPhones">0</span>
                        <span class="stat-label">Contacts</span>
                    </div>
                </div>
            </div>
            <div class="header-actions">
                <button class="action-btn refresh-btn" onclick="refreshDashboard()" title="Refresh Data">
                    <i class="fas fa-sync-alt"></i>
                    <span>Refresh</span>
                </button>
                <button class="action-btn export-btn" onclick="exportData()" title="Export Data">
                    <i class="fas fa-download"></i>
                    <span>Export</span>
                </button>
            </div>
        </div>
        
        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- Main Statistics Cards -->
            <div class="stats-section">
                <div class="section-header">
                    <h2><i class="fas fa-chart-bar"></i> Key Metrics</h2>
                    <p>Real-time statistics across all assemblies</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="card-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+12%</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="stat-number" id="totalAssemblies">0</div>
                            <div class="stat-label">Total Assemblies</div>
                            <div class="stat-description">Active data sources</div>
                        </div>
                    </div>
                    
                    <div class="stat-card success">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="card-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+8%</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="stat-number" id="totalGroups">0</div>
                            <div class="stat-label">WhatsApp Groups</div>
                            <div class="stat-description">Monitored groups</div>
                        </div>
                    </div>
                    
                    <div class="stat-card info">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="card-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+15%</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="stat-number" id="totalPhones">0</div>
                            <div class="stat-label">Phone Numbers</div>
                            <div class="stat-description">Total contacts</div>
                        </div>
                    </div>
                    
                    <div class="stat-card warning">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div class="card-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+5%</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="stat-number" id="totalMessages">0</div>
                            <div class="stat-label">Messages Analyzed</div>
                            <div class="stat-description">Data processed</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Assembly Overview -->
            <div class="assembly-section">
                <div class="section-header">
                    <h2><i class="fas fa-list-alt"></i> Assembly Overview</h2>
                    <p>Detailed breakdown by assembly</p>
                </div>
                
                <div class="assembly-container" id="assemblyBreakdown">
                    <div class="loading-state">
                        <div class="loading-spinner">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                        <div class="loading-text">
                            <h3>Loading Assembly Data</h3>
                            <p>Scanning CSV files and analyzing phone numbers...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="actions-section">
                <div class="section-header">
                    <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
                    <p>Common tasks and shortcuts</p>
                </div>
                
                <div class="actions-grid">
                    <a href="{{ url_for('user.whatsapp_analysis') }}" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="action-content">
                            <h3>WhatsApp Analysis</h3>
                            <p>Analyze messages and sentiment</p>
                        </div>
                        <div class="action-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </a>
                    
                    <a href="{{ url_for('user.advanced_search') }}" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="action-content">
                            <h3>Advanced Search</h3>
                            <p>Search across all messages</p>
                        </div>
                        <div class="action-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </a>
                    
                    <a href="{{ url_for('user.whatsapp_groups_list') }}" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="action-content">
                            <h3>Groups List</h3>
                            <p>View all WhatsApp groups</p>
                        </div>
                        <div class="action-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </a>
                    
                    <a href="{{ url_for('user.manage_topics') }}" class="action-card">
                        <div class="action-icon">
                            <i class="fas fa-tags"></i>
                        </div>
                        <div class="action-content">
                            <h3>Manage Topics</h3>
                            <p>Organize group labels</p>
                        </div>
                        <div class="action-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Include JavaScript -->
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script src="{{ url_for('static', filename='js/user_dashboard.js') }}"></script>
{% endblock %}